"use strict";var map,restaurant=void 0;window.initMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})};var fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var e=getParameterByName("id");e?DBHelper.fetchRestaurantById(e,function(e,t){(self.restaurant=t)?(fillRestaurantHTML(),r(null,t)):console.error(e)}):(error="No restaurant id in URL",r(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=DBHelper.imageUrlForRestaurant(e);document.getElementById("restaurant-source-large-webp").srcset=t+"-1600_large.webp 2x, "+t+"-800_large.webp",document.getElementById("restaurant-source-large").srcset=t+"-1600_large.jpg 2x, "+t+"-800_large.jpg",document.getElementById("restaurant-source-medium-webp").srcset=DBHelper.imageUrlForRestaurant(e)+"_medium.webp",document.getElementById("restaurant-source-medium").srcset=DBHelper.imageUrlForRestaurant(e)+"_medium.jpg",document.getElementById("restaurant-source-webp").srcset=DBHelper.imageUrlForRestaurant(e)+".webp";var r=document.getElementById("restaurant-img");r.className="restaurant-img",r.src=DBHelper.imageUrlForRestaurant(e)+".jpg",r.alt=e.name+" is a "+e.cuisine_type+" restaurant in "+e.address+".",document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var r in e){var n=document.createElement("tr"),a=document.createElement("td");a.innerHTML=r,n.appendChild(a);var l=document.createElement("td");l.innerHTML=e[r],n.appendChild(l),t.appendChild(n)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),r=document.createElement("h3");if(r.innerHTML="Reviews",t.appendChild(r),!e){var n=document.createElement("p");return n.innerHTML="No reviews yet!",void t.appendChild(n)}var a=document.getElementById("reviews-list");e.forEach(function(e){a.appendChild(createReviewHTML(e))}),t.appendChild(a)},createReviewHTML=function(e){var t=document.createElement("li"),r=document.createElement("p");r.innerHTML=e.name,t.appendChild(r);var n=document.createElement("p");n.innerHTML=e.date,t.appendChild(n);var a=document.createElement("p");a.innerHTML="Rating: "+e.rating,t.appendChild(a);var l=document.createElement("p");return l.innerHTML=e.comments,t.appendChild(l),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),r=document.createElement("li");r.setAttribute("aria-current","page"),r.innerHTML=e.name,t.appendChild(r)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJtYXAiLCJyZXN0YXVyYW50Iiwid2luZG93IiwiaW5pdE1hcCIsImZldGNoUmVzdGF1cmFudEZyb21VUkwiLCJlcnJvciIsInNlbGYiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNvbnNvbGUiLCJjZW50ZXIiLCJsYXRsbmciLCJzY3JvbGx3aGVlbCIsImNhbGxiYWNrIiwiaWQiLCJnZXRQYXJhbWV0ZXJCeU5hbWUiLCJEQkhlbHBlciIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJpbm5lckhUTUwiLCJuYW1lIiwiYWRkcmVzcyIsImltZ1NvdXJjZSIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsInNyY3NldCIsImxhcmdlU291cmNlV2VicCIsImxhcmdlU291cmNlIiwibWVkaXVtU291cmNlV2VicCIsImltYWdlIiwibWVkaXVtU291cmNlIiwiYWx0IiwiY3Vpc2luZV90eXBlIiwiY3Vpc2luZSIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwib3BlcmF0aW5nSG91cnMiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmV2aWV3c0hUTUwiLCJrZXkiLCJyb3ciLCJjcmVhdGVFbGVtZW50IiwiZGF5IiwidGltZSIsImhvdXJzIiwiYXBwZW5kQ2hpbGQiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwidGl0bGUiLCJub1Jldmlld3MiLCJjcmVhdGVSZXZpZXdIVE1MIiwicmV2aWV3IiwidWwiLCJmb3JFYWNoIiwibGkiLCJkYXRlIiwicmF0aW5nIiwiY29tbWVudHMiLCJmaWxsQnJlYWRjcnVtYiIsImJyZWFkY3J1bWIiLCJ1cmwiLCJsb2NhdGlvbiIsImhyZWYiLCJleGVjIiwicmVzdWx0cyIsImRlY29kZVVSSUNvbXBvbmVudCIsInJlcGxhY2UiXSwibWFwcGluZ3Mi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ZXN0YXVyYW50X2luZm8uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudDtcbnZhciBtYXA7XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuICovXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcbiAgICAgICAgem9vbTogMTYsXG4gICAgICAgIGNlbnRlcjogcmVzdGF1cmFudC5sYXRsbmcsXG4gICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxuICAgICAgfSk7XG4gICAgICBmaWxsQnJlYWRjcnVtYigpO1xuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcbiAgICB9XG4gIH0pO1xufTtcblxuLyoqXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXG4gKi9cbnZhciBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XG4gIGlmIChzZWxmLnJlc3RhdXJhbnQpIHsgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KTtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XG4gIGlmICghaWQpIHsgLy8gbm8gaWQgZm91bmQgaW4gVVJMXG4gICAgZXJyb3IgPSAnTm8gcmVzdGF1cmFudCBpZCBpbiBVUkwnO1xuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcbiAgfSBlbHNlIHtcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICAgIHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnQ7XG4gICAgICBpZiAoIXJlc3RhdXJhbnQpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xuICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudCk7XG4gICAgfSk7XG4gIH1cbn07XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXG4gKi9cbnZhciBmaWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpO1xuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcblxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcblxuICBjb25zdCBpbWdTb3VyY2UgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG5cbiAgY29uc3QgbGFyZ2VTb3VyY2VXZWJwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtc291cmNlLWxhcmdlLXdlYnAnKTtcbiAgbGFyZ2VTb3VyY2VXZWJwLnNyY3NldCA9IGltZ1NvdXJjZSArICctMTYwMF9sYXJnZS53ZWJwIDJ4LCAnICsgaW1nU291cmNlICsnLTgwMF9sYXJnZS53ZWJwJztcblxuICBjb25zdCBsYXJnZVNvdXJjZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LXNvdXJjZS1sYXJnZScpO1xuICBsYXJnZVNvdXJjZS5zcmNzZXQgPSBpbWdTb3VyY2UgKyAnLTE2MDBfbGFyZ2UuanBnIDJ4LCAnICsgaW1nU291cmNlICsnLTgwMF9sYXJnZS5qcGcnO1xuXG4gIGNvbnN0IG1lZGl1bVNvdXJjZVdlYnAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1zb3VyY2UtbWVkaXVtLXdlYnAnKTtcbiAgbWVkaXVtU291cmNlV2VicC5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkgKyAnX21lZGl1bS53ZWJwJztcblxuICBjb25zdCBtZWRpdW1Tb3VyY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1zb3VyY2UtbWVkaXVtJyk7XG4gIG1lZGl1bVNvdXJjZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkgKyAnX21lZGl1bS5qcGcnO1xuXG4gIGNvbnN0IHdlYnBTb3VyY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1zb3VyY2Utd2VicCcpO1xuICB3ZWJwU291cmNlLnNyY3NldCA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSArICcud2VicCc7XG5cbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcbiAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpICsgJy5qcGcnO1xuICBpbWFnZS5hbHQgPSByZXN0YXVyYW50Lm5hbWUgKyAnIGlzIGEgJyArIHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlICsgJyByZXN0YXVyYW50IGluICcgKyByZXN0YXVyYW50LmFkZHJlc3MgKyAnLic7XG5cbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcblxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcbiAgICBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuICB9XG4gIC8vIGZpbGwgcmV2aWV3c1xuICBmaWxsUmV2aWV3c0hUTUwoKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xudmFyIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3VycykgPT4ge1xuICBjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJyk7XG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG5cbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgIGRheS5pbm5lckhUTUwgPSBrZXk7XG4gICAgcm93LmFwcGVuZENoaWxkKGRheSk7XG5cbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpO1xuXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KTtcbiAgfVxufTtcblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbnZhciBmaWxsUmV2aWV3c0hUTUwgPSAocmV2aWV3cyA9IHNlbGYucmVzdGF1cmFudC5yZXZpZXdzKSA9PiB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWNvbnRhaW5lcicpO1xuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJztcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRpdGxlKTtcblxuICBpZiAoIXJldmlld3MpIHtcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XG4gICAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKTtcbiAgfSk7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XG59O1xuXG4vKipcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG52YXIgY3JlYXRlUmV2aWV3SFRNTCA9IChyZXZpZXcpID0+IHtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xuICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcblxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBkYXRlLmlubmVySFRNTCA9IHJldmlldy5kYXRlO1xuICBsaS5hcHBlbmRDaGlsZChkYXRlKTtcblxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcblxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XG5cbiAgcmV0dXJuIGxpO1xufTtcblxuLyoqXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxuICovXG52YXIgZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudD1zZWxmLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgbGkuc2V0QXR0cmlidXRlKCdhcmlhLWN1cnJlbnQnLCAncGFnZScpO1xuICBsaS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG4gIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xufTtcblxuLyoqXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxuICovXG52YXIgZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xuICBpZiAoIXVybClcbiAgICB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xuICBpZiAoIXJlc3VsdHMpXG4gICAgcmV0dXJuIG51bGw7XG4gIGlmICghcmVzdWx0c1syXSlcbiAgICByZXR1cm4gJyc7XG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XG59O1xuIl19
